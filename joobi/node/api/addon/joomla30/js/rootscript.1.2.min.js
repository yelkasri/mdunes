var jnedfd=new Array();var jnedinst=new Array();var jareaids=new Array();var jphpareaids=new Array();jQuery(document).keypress(function(f){if(f.which==13){var a=f.target.id;for(var d in jCore.txtA){if(typeof jCore.txtA[d]!="undefined"){var b="xt_"+jCore.txtA[d];if(a==jCore.txtA[d]||a==b){return true}}}if(jCore.ajx){if(typeof jCore.prssEnter!="undefined"){var c=jCore.prssEnter.split("|");joobi.rj(c[0],c[1])}}else{if(typeof jCore.prssEnter!="undefined"){joobi.run(jCore.prssEnter)}}}});function termsChecked(a){if(a){jCore.termVal+=1}else{jCore.termVal-=1}}function wzClosePopUp(b,a){if(typeof b!="undefined"&&b){jQuery("#wzpOpUp").modal("hide");location.reload()}else{if(typeof a!="undefined"&&a){jQuery("#wzpOpUp").modal("hide")}}}function jAppW(){this.buttons=new Array();this.x=new Array();this.autocheckVar=false;this.onDOMready=function(codePassed){jCore.DOMcodeToFire.push(codePassed);if(jCore.DOMfctset===false){this.browserDOMready()}};this.browserDOMready=function(){jCore.DOMfctset=true;document.addEventListener("DOMContentLoaded",jCore.DOMready,null)};this.rj=function(fName,task,xjson){var form=eval("document."+fName);jQuery(jCore.dv).addClass("ldng");var xtd="";if(typeof xjson!="undefined"){xtd=xjson}var opt=jQuery("#whdopt").val();var ctrA=task.split("|");var url=jCore.url+"?option="+opt+"&controller="+ctrA[0]+"&task="+ctrA[1];jQuery('input[type="hidden"][name="controller"]').remove();jQuery('input[type="hidden"][name="task"]').remove();if(typeof form.type!="undefined"){jQuery("<input>").attr({type:"hidden",name:"jbiType",id:"jbiType"}).appendTo(form);jQuery(form.jbiType).val(form.type.value);jQuery(form.type).val("raw")}if(task==="order"){var reA=xjson.split("=");if(reA[1]=="all&total"){for(var j=0;j<=reA[2];j++){box=eval("form.em"+j);if(box){box.checked=true}}}}var uX="";uX+="&wajx=1&wmjx=1"+jCore.fmU;if(xtd){uX+="&"+xtd}jQuery.ajax({url:url+uX,data:jQuery(form).serialize(),method:"POST",async:true,success:function(msg){WAjaxMultiResp(msg)},error:function(msg){}});jQuery(jCore.dv).removeClass("ldng");return false};this.rjcf=function(fName,task,xjson,cfrm,slct,hsBtn){if(typeof slct!="undefined"&&slct!=""){var form=eval("document."+fName);if(form.boxchecked.value==0){alert(slct);return false}}if(typeof cfrm!="undefined"&&cfrm!=""){if(!confirm(cfrm)){return false}}if(typeof hsBtn!="undefined"){var btn=jQuery(hsBtn);window.WApps.helpers.BtnLoad(btn)}this.rj(fName,task,xjson);if(typeof hsBtn!="undefined"){window.WApps.helpers.BtnRst(btn)}return false};this.rjvl=function(fName,task,xjson,hsBtn){if(typeof hsBtn!="undefined"){var btn=jQuery(hsBtn);window.WApps.helpers.BtnLoad(btn)}if(!this.validate(fName)){return false}if(typeof jnedinst!="undefined"){this.loadNeditData()}if(typeof jphpareaids!="undefined"){this.loadPHPeditData()}this.rj(fName,task,xjson);if(typeof hsBtn!="undefined"){window.WApps.helpers.BtnRst(btn)}return false};this.wdt=function(width){screen_width=document.compatMode=="CSS1Compat"&&!window.opera?document.documentElement.clientWidth:document.body.clientWidth;return Math.ceil((width*screen_width)/100)};this.hgt=function(height){if(navigator.userAgent.toLowerCase().indexOf("opera")>-1){screen_height=document.documentElement.clientHeight}else{screen_height=document.compatMode=="CSS1Compat"&&!window.opera?document.documentElement.clientHeight:document.body.clientHeight}return Math.ceil((height*screen_height)/100)};this.tr=function(url){jQuery.ajax({url:url,method:"POST",async:true,success:function(msg){var el=jQuery(".hopscotch-bubble");el.addClass("hide")},error:function(msg){}});return false};this.run=function(namekey,extra,htmlEntity){var btn=this.buttons[namekey];this.form=eval("document."+btn.formName);if(btn.wizard){return this.wizard(btn)}if(btn.autocheck){return this.autocheck(btn,extra)}if(btn.nosubmit){return this.checkbox(btn,extra)}if(btn.rqCk&&!this.numChecked(btn.rqCkCl)){return false}if(btn.lstg){this.processTask(btn,extra)}if(btn.select&&!this.checkSelection(btn,namekey)){return false}if(btn.confirm&&!this.askConfirmation(namekey)){return false}this.loadNeditData();if(btn.phpedit){this.loadPHPeditData()}if(btn.validation&&!this.validate(btn.formName)){return false}if(btn.pagi){this.navPagi(btn.limitstart,extra)}if(btn.cfil){this.changeFilter(btn.limitstart)}if(btn.disable&&htmlEntity){window.WApps.helpers.changeButtons(htmlEntity)}this.sendForm(btn,namekey,extra);return false};this.beforeAutosave=function(namekey,extra,htmlEntity){var btn=this.buttons[namekey];if(typeof btn=="undefined"){return true}this.form=eval("document."+btn.formName);this.loadNeditData();if(btn.phpedit){this.loadPHPeditData()}return true};this.autocheck=function(button,extra){extra.value=jQuery(extra.namekey).value;if(extra.value==""||extra.value==0){return true}notexist=extra.notexist;var form=eval("document."+button.formName);var task=eval(form.task);if(task){form.task.value=button.task}var extraStr="";for(var i in extra){index=i;extraStr+="&"+i+"="+extra[i]}var url=button.ajxUrl;jQuery.ajax({url:url,data:jQuery(form).serialize()+extraStr+"&controller=output",method:"POST",success:function(msg){if(notexist==1){if(msg==0){msg=1}else{msg=0}}if(msg==1){joobi.autocheckVar=true}else{joobi.autocheckVar=false}}})};this.processTask=function(btn,extra){if(typeof btn=="undefined"){return}if(btn.ajx){if(btn.zsid){extra.zsid=btn.zsid}if(btn.zmap){extra.zmap=btn.zmap}if(btn.zsc){extra.zsc=btn.zsc}}else{if(typeof extra!="undefined"&&extra.zval){btn.zval=extra.zval}var a=["zact","zsid","zmap","zval","zsc"];var l=a.length;for(var i=0;i<l;i++){if(btn[a[i]]){var input=jQuery("<input>").attr("type","hidden").attr("name",a[i]).val(btn[a[i]]);jQuery("#"+btn.formName).append(jQuery(input))}}}switch(btn.task){case"order":if(btn.total){for(var j=0;j<=btn.total;j++){box=eval("this.form.em"+j);if(box){box.checked=true}}}else{this.checkLine(extra)}break;default:if(extra.em){this.tickBox(extra.em)}}if(btn.sorting){this.form.sorting.value=extra;task=btn.params}};this.numChecked=function(idName){if(jCore.termVal==jCore.termCtn){return"true"}else{alert(jCore.termMsg);return""}};this.tickBox=function(id){box=eval("this.form."+id);if(box){box.checked=true;this.form.boxchecked.value=1}else{return false}};this.checkbox=function(button,extra){switch(button.task){case"toggleAllBox":box=jQuery(button.checkid);var i=button.limitstart;var currentElement=eval("this.form.em"+i);while(currentElement){em=jQuery("#em"+i);em.prop("checked",box.prop("checked"));i++;currentElement=eval("this.form.em"+i)}if(extra){this.form.boxchecked.value=i}else{this.form.boxchecked.value=0}break;case"checkLine":this.checkLine(extra);break}return true};this.flip=function(htmlId,msg){htmlEntity=jQuery(htmlId);if(msg){msgEntity=jQuery("msg"+htmlId)}if(htmlEntity.style.display=="none"){htmlEntity.style.display="block";if(msg){msgEntity.style.display="none"}}else{htmlEntity.style.display="none";if(msg){msgEntity.style.display="block"}}};this.flipChild=function(htmlId){htmlEntity=jQuery(htmlId);var i=0;for(i=0;i<htmlEntity.childNodes.length;i++){if(htmlEntity.childNodes[i].style.display=="none"){htmlEntity.childNodes[i].style.display="block"}else{htmlEntity.childNodes[i].style.display="none"}}};this.checkLine=function(boxid){boxRadio=eval("this.form."+boxid);parentObj=boxRadio;runaway=false;while(!runaway){if(parentObj){parentObj=parentObj.parentNode}if(parentObj&&parentObj.nodeName=="BODY"){return false}if(parentObj&&parentObj.nodeName=="TR"){runaway=true}if(!parentObj){return false}}parentid=parentObj.getAttribute("id");box=document.getElementById(boxid);row=document.getElementById(parentid);if(row.className){row.className=jQuery.trim(row.className)}if(row.className.indexOf("rowSelected")==-1){if(box.checked==true){box.checked=false}}if(row.className.indexOf("rowSelected")!=-1){if(box.checked==false){box.checked=true}}if(box.checked==true){box.checked=false;this.form.boxchecked.value--;row.className=row.className.substring(0,4)}else{if(box.type=="radio"){if(this.form.boxchecked.value==1){this.form.boxchecked.value--}var tr=document.getElementsByTagName("tr");for(var i=0;i<tr.length;i++){cssclass=tr[i].className;if(cssclass.indexOf("rowSelected")!=-1){cssclass=cssclass.substring(0,4);tr[i].className=cssclass}}}box.checked=true;this.form.boxchecked.value++;row.className+=" rowSelected"}return true};this.changeFilter=function(limitname){limitstart=eval("this.form."+limitname);if(limitstart){limitstart.value=""}};this.navPagi=function(limitname,extra){limitstart=eval("this.form."+limitname);limitstart.value=extra};this.validate=function(formname){if(!(typeof validateForm=="function")){return true}var status=validateForm(formname);return status};this.checkSelection=function(btn,namekey){var form=eval("document."+btn.formName);if(form.boxchecked.value==0){alert(jCore.msg["selec_"+namekey]);return false}return true};this.askConfirmation=function(namekey){if(confirm(jCore.msg["conf_"+namekey])){return true}else{return false}};this.loadNeditData=function(){for(i=0;i<jnedinst.length;i++){textbox=jQuery("#"+jareaids[i]);if(jnedinst[i].innerHTML=="<br>"){textbox.val("")}else{textbox.val(jnedinst[i].innerHTML)}}return false};this.loadPHPeditData=function(){for(i=0;i<jphpareaids.length;i++){textbox=jQuery("#"+jphpareaids[i]);textbox.val(editAreaLoader.getValue(jphpareaids[i]))}return false};this.sendForm=function(button,namekey,extra){var form=eval("document."+button.formName);var task=eval(form.task);if(task){form.task.value=button.task}if(button.eid){var myEID=eval(form.eid);if(myEID){form.eid.value=button.eid}}if(button.controller){var contro=eval(form.controller);if(contro){contro.value=button.controller}}if(button.refresh||button.popclose){button.ajx=1}if(button.ajx==1){jCore.ajxprms.url=button.ajxUrl;var url=jCore.ajxprms.url;jCore.ajxprms.on=button.ajx;jCore.ajxprms.extfct=button.ajxComplete;var extraData="";var action="eval";if(button.ajaxToggle){var extraStr="";jCore.ajxprms.div=extra.divId;if(extra.act){action=extra.act}for(var i in extra){index=i;extraStr+="&"+i+"="+extra[i]}extraData="&ajax=1&namekey="+namekey+extraStr}else{jCore.ajxprms.div="div"+button.formName}var func=eval("window."+jCore.ajxprms.extfct);if(typeof joobiAjax!="undefined"){joobiAjax.run(url,button,form);return true}if(button.refresh||button.popclose){window.parent.wzClosePopUp(button.refresh,button.popclose)}if(func){jQuery.ajax({url:url,data:jQuery(form).serialize(),method:"POST",async:false,success:function(msg){func(msg,url,form)}})}else{if(button.mltRtrn){jQuery.ajax({url:url,data:jQuery(form).serialize()+extraData,method:"POST",async:false,success:function(msg){WAjaxMultiResp(msg)},error:function(msg){}})}else{jQuery.ajax({url:url,data:jQuery(form).serialize()+extraData,method:"POST",async:false,success:function(msg){WAjaxResp(msg,jCore.ajxprms.div,action)},error:function(msg){}})}}}else{try{jQuery(form).submit()}catch(e){}status=form.submit()}if(typeof jCore.isAdmin!="undefined"&&jCore.isAdmin=="admin"){if(button.refresh){parent.location.reload()}else{if(button.popclose){return window.parent.SqueezeBox.close()}}}else{window.parent.wzClosePopUp(button.refresh,button.popclose)}return true};this.wait=function(msecs){var start=new Date().getTime();var cur=start;while(cur-start<msecs){cur=new Date().getTime()}};this.creditcard=function(namekey,cardnameid,cardnumid,expdateid){var btn=this.buttons[namekey];var formName=btn.formName;if(!this.validate(formName)){return false}if(!checkCreditCard(cardnameid,cardnumid)){return false}this.sendForm(btn);return false};this.wizard=function(button){myElement=jQuery("#viewWizard");var display=myElement.css("display");if(display=="none"){myElement.show()}else{myElement.hide()}var form=eval("document."+button.formName);var task=eval(form.task);if(task){form.task.value=button.task}var url=jCore.ajxprms.url;jQuery.ajax({url:url,data:jQuery(form).serialize()+"&controller=output",method:"POST",success:function(msg){},error:function(){}})}}var joobi=new jAppW();var jCore={url:"index.php",fmU:"&tmpl=component&type=raw",dv:"",ajx:0,confirm:[],nedit:false,ajxprms:[],DOMfctset:false,DOMcodeToFire:[],msg:[],req:[],txtA:[],termCtn:"",termMsg:"",termVal:0,DOMready:function(){for(i=0;i<jCore.DOMcodeToFire.length;i++){jCore.DOMcodeToFire[i]()}}};function WAjaxResp(c,d,b){var a="";return jwriteResponse(c,d,a,b)}function WAjaxMultiResp(msg){var obj=jQuery.parseJSON(msg);for(i=0;i<obj.length;i++){var item=obj[i];switch(item.act){case"append":jQuery(item.div).append(item.val);break;case"replace":jQuery(item.div).replaceWith(item.val);break;case"html":jQuery(item.div).html(item.val);break;case"redirect":window.location.href=item.val;break;case"file":jQuery.getScript(item.val);break;case"eval":default:if(item.val){eval(item.val)}break}}}function jwriteResponse(msg,div,classes,action){if(!msg){return}if(!action){action="html"}if("eval"!=action&&div[0]!="#"){div="#"+div}mydiv=jQuery(div);if(mydiv){if("append"==action){jQuery(div).append(msg)}else{if("replace"==action){jQuery(div).replaceWith(msg)}else{if("html"==action){jQuery(div).html(msg)}else{eval(msg)}}}}};