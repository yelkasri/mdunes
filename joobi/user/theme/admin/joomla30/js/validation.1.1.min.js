var W3CDOM=(document.getElementsByTagName&&document.createElement);var jradios=new Array();var joobiErrorTabs=new Array();var joobiErrorFields=new Array();var joobiTabs=false;function validateForm(d){var c=document.forms[d].elements;formHasError=false;fullErrorString="";firstError=null;currEmtype=null;prevEm=false;radios=new Array();for(var b=0;b<c.length;b++){if(c[b].type!="hidden"){validateField(c[b],d)}}if(prevEm&&prevEm.type=="radio"&&jradios[d][prevEm.name]===false){writeError(prevEm,jCore.msg.req,radios[prevEm.name]);prevEm=null}if(!W3CDOM){alert(fullErrorString)}if(firstError){firstError.focus()}var a=jQuery('form[name="'+d+'"] .tab-pane');var e=jQuery('form[name="'+d+'"] .nav-tabs li');if(a.length&&e.length){jQuery.each(a,function(f,g){ifHasError=jQuery(g).find(".jberror");if(ifHasError.length){jQuery(e[f]).find("h3").css("color","red")}else{jQuery(e[f]).find("h3").css("color","")}})}if(formHasError){return false}return true}function validateField(formElement,formName){if(typeof jCore.req[formName]=="undefined"||!jCore.req[formName]){return true}if(typeof jCore.req[formName][formElement.name]=="undefined"||!jCore.req[formName][formElement.name]){return true}currEmtype=formElement.type;if(prevEm&&prevEm.type=="radio"&&currEmtype!=prevEm.type&&jradios[formName][prevEm.name]===false){writeError(prevEm,jCore.msg.req,radios[prevEm.name]);prevEm=null}if(currEmtype==undefined){return false}var str=new String(jCore.req[formName][formElement.name]);var requiredTypes=str.match(/[a-zA-Z]+(?=(,|\())/g);var requiredArgs=str.match(/\([a-zA-Z0-9_\)\(\\\<\>\"\'\;\&\+\-\$\^\*\%]*(?=(,|\s;\s))/g);if(formElement.value){newValue=formElement.value.split(" ").join("");if(!newValue){formElement.value=""}}if(!formElement.value||(currEmtype=="checkbox"&&!formElement.checked)||(currEmtype=="select-one"&&formElement.value==0)||(currEmtype=="radio")){if(jCore.req[formName][formElement.name]!=null){if(currEmtype=="radio"){if(!eval(radios[formElement.name])){radios[formElement.name]=new Array()}radios[formElement.name][formElement.value]=formElement;if(!eval(jradios[formName])){jradios[formName]=new Array()}if(eval(jradios[formName][formElement.name])&&jradios[formName][formElement.name]===true){return false}jradios[formName][formElement.name]=formElement.checked;prevEm=formElement;return false}writeError(formElement,jCore.msg.req)}}else{if(jCore.req[formName][formElement.name]&&jCore.req[formName][formElement.name]!=0){for(var k=0;k<requiredTypes.length;k++){strArgs=new String(requiredArgs[k]);jFlagError=false;validateType(formElement,requiredTypes[k]);if(jFlagError){writeError(formElement,jCore.msg[requiredTypes[k]])}}}}}function validateType(k,j){var c="0123456789.,-+";var l=/[0-9]+/g;var b=/[a-z]+/gi;var m=/[a-z0-9]+/gi;switch(j){case"num":if(!isLike(k.value,c)){jFlagError=true}break;case"numeric":if(!isLike(k.value,l)){jFlagError=true}break;case"alpha":var g=k.value.match(b);if(!g){jFlagError=true}break;case"alphanum":var g=k.value.match(m);if(!g){jFlagError=true}break;case"ws":var g=k.value.match(/(\s)/);if(g){jFlagError=true}break;case"email":var f=/^[^@]*@([a-zA-Z0-9\-]+\.)+[a-zA-Z0-9]{2,7}$/;if(!verifyPattern(f,k.value)){jFlagError=true}break;case"minlgt":var o=strArgs.match(/[a-zA-Z0-9]+/g);var e=o[0];if(k.value.length<e){jFlagError=true}break;case"inf":var o=strArgs.match(/[a-zA-Z0-9]+/g);var e=o[0];if(!(k.value<e)){jFlagError=true}break;case"sup":var o=strArgs.match(/[a-zA-Z0-9]+/g);var e=o[0];if(!(k.value>e)){jFlagError=true}break;case"nozero":if(k.value==0){jFlagError=true}break;case"autocheck":if(joobi.autocheckVar){jFlagError=true}break;case"maxlgt":var o=strArgs.match(/[a-zA-Z0-9]+/g);var e=o[0];if(k.value.length>e){jFlagError=true}break;case"sameas":var o=strArgs.match(/[a-zA-Z0-9_]+/g);var a=$(o[0]);if(a.value!=k.value){jFlagError=true;writeError(a,jCore.msg[j])}break;case"date":break;case"ccontain":var o=strArgs.match(/[\W]*(?=(\)))/g);var h=new String(o);h=h.substring(1,h.length);if(notContains(k.value,h)){jFlagError=true}break;case"cncontain":var o=strArgs.match(/[\W]*(?=(\)))/g);var h=new String(o);h=h.substring(1,h.length);var n=new String(jCore.msg[j]);var d=n.replace(/\[ILLEGAL_CHAR\]/,h);if(!notContains(k.value,h)){writeError(k,d)}break;default:break}}function verifyPattern(b,c){var a=new RegExp(b);return a.test(c)}function notContains(c,d){var b=true;var a;for(i=0;i<c.length&&b==true;i++){a=c.charAt(i);if(d.indexOf(a)!=-1){b=false}}return b}function isLike(d,a){var c=true;var b;for(i=0;i<d.length&&c==true;i++){b=d.charAt(i);if(a.indexOf(b)==-1){c=false}}return c}function isNotLike(c,a){var d=false;var b;for(i=0;i<c.length&&d==false;i++){b=c.charAt(i);if(a.indexOf(b)==-1){d=true}}return d}function writeError(c,a,b){if(joobiTabs){writeErrorTab(c)}if(!firstError){formHasError=true;firstError=c}if(c.hasError){return}if(W3CDOM){c.className+=" jberror";c.onchange=function(){removeError(this,joobiTabs)};if(b){for(objectheu in b){b[objectheu].onchange=function(){removeError(c,joobiTabs)}}}writeMess(c,a)}else{fullErrorString+=c.name+": "+a+"\n";c.hasError=true}}function writeErrorTab(obj){var parentObj=obj.parentNode;var runaway=false;while(!runaway){parentObj=parentObj.parentNode;if(parentObj.nodeName=="BODY"){return false}if(parentObj.nodeName!="DIV"||(parentObj.nodeName=="DIV"&&parentObj.className!="tab-page")){continue}else{parentid=parentObj.getAttribute("id");TabdivHeadName=parentObj.getAttribute("name");if(TabdivHeadName=="tabjb"){if(!eval(joobiErrorFields[parentid])){joobiErrorFields[parentid]=new Array()}joobiErrorFields[parentid].push(obj.getAttribute("id"));for(var i=0;i<joobiErrorTabs.length;i++){if(joobiErrorTabs[i]==TabdivHeadName){return true}else{continue}}TabspanHead=$("jtspan"+parentid);TabspanHead.className+=" jberror";joobiErrorTabs.push(parentid);runaway=true}else{continue}}}}function writeMess(c,a){var b=document.createElement("span");b.className="text jberror";b.appendChild(document.createTextNode(a));c.parentNode.appendChild(b);c.hasError=b}function removeError(a,b){if(b){removeErrorTabs(a)}a.className=a.className.substring(0,a.className.lastIndexOf(" "));a.parentNode.removeChild(a.hasError);a.hasError=null;a.onchange=null}function removeErrorTabs(b){for(tabs in joobiErrorFields){var a=false;for(i=0;i<joobiErrorFields[tabs].length;i++){if(joobiErrorFields[tabs][i]===true){continue}if(joobiErrorFields[tabs][i]==b.getAttribute("id")){joobiErrorFields[tabs][i]=true}if((a===false)||(a===true)){a=joobiErrorFields[tabs][i]}}if(a===true){tabObj=$("jtspan"+tabs);tabObj.className=tabObj.className.substring(0,tabObj.className.lastIndexOf(" "));tabObj.onchange=null}}};